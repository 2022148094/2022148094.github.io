{% assign item = include.item %}
<style>
.pub-desc {
    display: none;
}
.pub-desc.show {
    display: block;
}
.toggle-desc-btn {
    cursor: pointer;
    color: #0366d6;
    text-decoration: none;
    font-size: 0.875rem;
    margin-left: 0.25rem;
}
.toggle-desc-btn:hover {
    text-decoration: underline;
}
.logo-image {
    max-width: 60px;
    max-height: 60px;
    margin-left: 10px;
    vertical-align: middle;
    border-radius: 50%;
    object-fit: cover;
}
</style>

<!-- Desktop view -->
<div class="d-none d-md-block">
    <div class="row no-gutters {% unless include.hide_bottom_border %}border-bottom{% endunless %} border-gray">
        <div class="col-md-3 col-xl-2 mb-md-0 p-md-3">
            {%- if item.cover -%}
            <img src="{{ '/assets/images/empty_300x200.png' | relative_url }}" data-src="{{ '/assets/images/photos/yonsei_cs_logo.png' | relative_url }}" alt="{{ item.title }}" class="lazy w-100 rounded-sm" />
            {%- else -%}
            <svg class="bubble-visual-hash lazy w-100 rounded-sm" data-bubble-visual-hash="{{ item.id }}" viewBox="0 0 300 200"></svg>
            {%- endif -%}
        </div>
        <div class="col-md-9 col-xl-10 p-3 pl-md-0">
            <h5 class="mt-0 mb-1 font-weight-normal">
                {{ item.title }}
                {%- if item.description -%}
                <span class="toggle-desc-btn" onclick="toggleDescription(this)">[More]</span>
                {%- endif -%}
            </h5>
            <div class="pub-desc" style="margin-top: 0.5rem; margin-bottom: 0.5rem;">
                {{ item.description }}
            </div>
            {%- if item.course -%}
            <p class="mb-1">
                Course: {{ item.course }}
                {%- if item.logo -%}
                <img src="{{ item.logo | relative_url }}" class="logo-image" alt="{{ item.course }} logo" />
                {%- endif -%}
            </p>
            {%- endif -%}
            {%- if item.author -%}
            <p class="mt-0 mb-0 small">{{ item.author }}</p>
            {%- endif -%}
            {%- if item.venue or item.publication_date -%}
            <p class="mb-1">
                {%- if item.venue -%}
                Venue: {{ item.venue }}
                <br />
                {%- endif -%}
                {%- if item.publication_date -%}
                Date: {{ item.publication_date }}
                <br />
                {%- endif -%}
            </p>
            {%- endif -%}
            {%- if item.abstract -%}
            <details class="mt-2">
                <summary class="text-muted">Abstract</summary>
                <p class="mt-2">{{ item.abstract }}</p>
            </details>
            {%- endif -%}
            {%- if item.paper_url or item.code_url or item.video_url -%}
            <div class="d-flex flex-wrap">
                {%- if item.paper_url -%}
                <a href="{{ item.paper_url }}" class="btn btn-sm btn-outline-primary mr-2 mb-2" target="_blank">Paper</a>
                {%- endif -%}
                {%- if item.code_url -%}
                <a href="{{ item.code_url }}" class="btn btn-sm btn-outline-primary mr-2 mb-2" target="_blank">Code</a>
                {%- endif -%}
                {%- if item.video_url -%}
                <a href="{{ item.video_url }}" class="btn btn-sm btn-outline-primary mr-2 mb-2" target="_blank">Video</a>
                {%- endif -%}
            </div>
            {%- endif -%}
        </div>
    </div>
</div>

<!-- Mobile view -->
<div class="d-md-none border-bottom border-gray">
    <div class="p-3">
        <h5 class="mt-0 mb-1 font-weight-normal">
            {{ item.title }}
            {%- if item.description -%}
            <span class="toggle-desc-btn" onclick="toggleDescription(this)">[More]</span>
            {%- endif -%}
        </h5>
        <div class="pub-desc" style="margin-top: 0.5rem; margin-bottom: 0.5rem;">
            {{ item.description }}
        </div>
        {%- if item.course -%}
        <p class="mb-1">
            Course: {{ item.course }}
            {%- if item.logo -%}
            <img src="{{ item.logo | relative_url }}" class="logo-image" alt="{{ item.course }} logo" />
            {%- endif -%}
        </p>
        {%- endif -%}
        {%- if item.author -%}
        <p class="mt-0 mb-0 small">{{ item.author }}</p>
        {%- endif -%}
        {%- if item.venue or item.publication_date -%}
        <p class="mb-1">
            {%- if item.venue -%}
            Venue: {{ item.venue }}
            <br />
            {%- endif -%}
            {%- if item.publication_date -%}
            Date: {{ item.publication_date }}
            <br />
            {%- endif -%}
        </p>
        {%- endif -%}
        {%- if item.abstract -%}
        <details class="mt-2">
            <summary class="text-muted">Abstract</summary>
            <p class="mt-2">{{ item.abstract }}</p>
        </details>
        {%- endif -%}
        {%- if item.paper_url or item.code_url or item.video_url -%}
        <div class="d-flex flex-wrap">
            {%- if item.paper_url -%}
            <a href="{{ item.paper_url }}" class="btn btn-sm btn-outline-primary mr-2 mb-2" target="_blank">Paper</a>
            {%- endif -%}
            {%- if item.code_url -%}
            <a href="{{ item.code_url }}" class="btn btn-sm btn-outline-primary mr-2 mb-2" target="_blank">Code</a>
            {%- endif -%}
            {%- if item.video_url -%}
            <a href="{{ item.video_url }}" class="btn btn-sm btn-outline-primary mr-2 mb-2" target="_blank">Video</a>
            {%- endif -%}
        </div>
        {%- endif -%}
        {%- if item.cover -%}
        <img src="{{ '/assets/images/empty_300x200.png' | relative_url }}" data-src="{{ '/assets/images/photos/yonsei_cs_logo.png' | relative_url }}" alt="{{ item.title }}" class="lazy w-100 rounded-sm mt-2" />
        {%- else -%}
        <svg class="bubble-visual-hash lazy w-100 rounded-sm mt-2" data-bubble-visual-hash="{{ item.id }}" viewBox="0 0 300 200"></svg>
        {%- endif -%}
    </div>
</div>

<script>
function toggleDescription(element) {
    var descDiv = element.closest('h5').nextElementSibling;
    if (descDiv && descDiv.classList.contains('pub-desc')) {
        descDiv.classList.toggle('show');
        element.textContent = descDiv.classList.contains('show') ? '[Less]' : '[More]';
    }
}
</script>
